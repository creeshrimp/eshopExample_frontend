import{p as ue,ay as se,az as ye,q as ie,E as de,aA as ce,aB as xe,c as D,K as me,aC as ve,aD as j,L as a,M as E,aE as be,aF as ke,G as V,s as he,d as we,o as Ce,w as q,b as Pe,aG as Fe,aH as Ie,O as _,ab as ae,aI as Se,aJ as Ae,aK as Re,aL as $e,Q as J,aM as Me,a as Be,a1 as De,R as Ue,ae as Te,aN as Ne,U as qe,Y as le,W as ze,X as s,ax as Ee,aj as S,_ as He,ag as L,ah as B,ai as Ge,av as W,V as Oe,a0 as Le,ak as _e,Z as i,aO as je,au as Ke,at as Qe,aP as Je,aQ as We,an as Xe,ad as Ye}from"./index-Cpz43kHv.js";import{c as Ze,a as X,b as et,d as tt,u as at,e as z,V as lt}from"./index.esm-DFJiPoDg.js";import{b as oe}from"./route-block-B_A1xBdJ.js";import{a as ot,V as re}from"./VRow-CQGUY1bV.js";import{m as rt,a as ne,V as nt,b as ut}from"./VDataTable-VaiE7NLN.js";import{V as st}from"./VToolbar-9LolDu3L.js";import{V as it}from"./VContainer-TyyObbe_.js";import"./VPagination-d5yUPPHX.js";import"./VList-6AqYnrn2.js";import"./VMenu-kkW7sMFT.js";const dt=ue({...se(),...ye(rt(),["inline"])},"VCheckbox"),ct=ie()({name:"VCheckbox",inheritAttrs:!1,props:dt(),emits:{"update:modelValue":e=>!0,"update:focused":e=>!0},setup(e,u){let{attrs:y,slots:p}=u;const d=de(e,"modelValue"),{isFocused:c,focus:x,blur:A}=ce(e),m=xe(),R=D(()=>e.id||`checkbox-${m}`);return me(()=>{const[$,U]=ve(y),M=j.filterProps(e),b=ne.filterProps(e);return a(j,E({class:["v-checkbox",e.class]},$,M,{modelValue:d.value,"onUpdate:modelValue":h=>d.value=h,id:R.value,focused:c.value,style:e.style}),{...p,default:h=>{let{id:f,messagesId:w,isDisabled:g,isReadonly:C,isValid:P}=h;return a(ne,E(b,{id:f.value,"aria-describedby":w.value,disabled:g.value,readonly:C.value},U,{error:P.value===!1,modelValue:d.value,"onUpdate:modelValue":T=>d.value=T,onFocus:x,onBlur:A}),p)}})}),{}}}),mt=ue({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...se(),...be()},"VTextarea"),vt=ie()({name:"VTextarea",directives:{Intersect:ke},inheritAttrs:!1,props:mt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,u){let{attrs:y,emit:p,slots:d}=u;const c=de(e,"modelValue"),{isFocused:x,focus:A,blur:m}=ce(e),R=D(()=>typeof e.counterValue=="function"?e.counterValue(c.value):(c.value||"").toString().length),$=D(()=>{if(y.maxlength)return y.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter});function U(r,t){var n,k;!e.autofocus||!r||(k=(n=t[0].target)==null?void 0:n.focus)==null||k.call(n)}const M=V(),b=V(),h=he(""),f=V(),w=D(()=>e.persistentPlaceholder||x.value||e.active);function g(){var r;f.value!==document.activeElement&&((r=f.value)==null||r.focus()),x.value||A()}function C(r){g(),p("click:control",r)}function P(r){p("mousedown:control",r)}function T(r){r.stopPropagation(),g(),J(()=>{c.value="",Me(e["onClick:clear"],r)})}function H(r){var n;const t=r.target;if(c.value=t.value,(n=e.modelModifiers)!=null&&n.trim){const k=[t.selectionStart,t.selectionEnd];J(()=>{t.selectionStart=k[0],t.selectionEnd=k[1]})}}const v=V(),I=V(+e.rows),N=D(()=>["plain","underlined"].includes(e.variant));we(()=>{e.autoGrow||(I.value=+e.rows)});function l(){e.autoGrow&&J(()=>{if(!v.value||!b.value)return;const r=getComputedStyle(v.value),t=getComputedStyle(b.value.$el),n=parseFloat(r.getPropertyValue("--v-field-padding-top"))+parseFloat(r.getPropertyValue("--v-input-padding-top"))+parseFloat(r.getPropertyValue("--v-field-padding-bottom")),k=v.value.scrollHeight,G=parseFloat(r.lineHeight),K=Math.max(parseFloat(e.rows)*G+n,parseFloat(t.getPropertyValue("--v-input-control-height"))),Q=parseFloat(e.maxRows)*G+n||1/0,F=De(k??0,K,Q);I.value=Math.floor((F-n)/G),h.value=Be(F)})}Ce(l),q(c,l),q(()=>e.rows,l),q(()=>e.maxRows,l),q(()=>e.density,l);let o;return q(v,r=>{r?(o=new ResizeObserver(l),o.observe(v.value)):o==null||o.disconnect()}),Pe(()=>{o==null||o.disconnect()}),me(()=>{const r=!!(d.counter||e.counter||e.counterValue),t=!!(r||d.details),[n,k]=ve(y),{modelValue:G,...K}=j.filterProps(e),Q=Fe(e);return a(j,E({ref:M,modelValue:c.value,"onUpdate:modelValue":F=>c.value=F,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":N.value},e.class],style:e.style},n,K,{centerAffix:I.value===1&&!N.value,focused:x.value}),{...d,default:F=>{let{id:O,isDisabled:Y,isDirty:Z,isReadonly:fe,isValid:pe}=F;return a(Ie,E({ref:b,style:{"--v-textarea-control-height":h.value},onClick:C,onMousedown:P,"onClick:clear":T,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Q,{id:O.value,active:w.value||Z.value,centerAffix:I.value===1&&!N.value,dirty:Z.value||e.dirty,disabled:Y.value,focused:x.value,error:pe.value===!1}),{...d,default:ge=>{let{props:{class:ee,...te}}=ge;return a(_,null,[e.prefix&&a("span",{class:"v-text-field__prefix"},[e.prefix]),ae(a("textarea",E({ref:f,class:ee,value:c.value,onInput:H,autofocus:e.autofocus,readonly:fe.value,disabled:Y.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:g,onBlur:m},te,k),null),[[Se("intersect"),{handler:U},null,{once:!0}]]),e.autoGrow&&ae(a("textarea",{class:[ee,"v-textarea__sizer"],id:`${te.id}-sizer`,"onUpdate:modelValue":Ve=>c.value=Ve,ref:v,readonly:!0,"aria-hidden":"true"},null),[[Ae,c.value]]),e.suffix&&a("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:t?F=>{var O;return a(_,null,[(O=d.details)==null?void 0:O.call(d,F),r&&a(_,null,[a("span",null,null),a(Re,{active:e.persistentCounter||x.value,value:R.value,max:$.value,disabled:e.disabled},d.counter)])])}:void 0})}),$e({},M,b,f)}}),ft={class:"text-center"},pt={__name:"products",setup(e){const{t:u}=Ue(),{apiAuth:y}=Xe(),p=Te(),d=Ne([]),c=V(""),x=D(()=>[{title:"ID",key:"_id",sortable:!0},{title:u("product.image"),key:"image",sortable:!1},{title:u("product.name"),key:"name",sortable:!0},{title:u("product.description"),key:"description",sortable:!0},{title:u("product.price"),key:"price",sortable:!0},{title:u("product.category"),key:"category",sortable:!0},{title:u("product.sell"),key:"sell",sortable:!0},{title:u("product.createdAt"),key:"createdAt",sortable:!0},{title:u("product.updatedAt"),key:"updatedAt",sortable:!0}]);async function A(){var l,o;try{const{data:r}=await y.get("/product/all");d.push(...r.result)}catch(r){console.log(r),p({text:u("api."+(((o=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:o.message)||"unknownError")),snackbarProps:{color:"red"}})}}A();const m=V({open:!1,productId:""});function R(l){l&&(m.value.productId=l._id,f.value.value=l.name,w.value.value=l.price,g.value.value=l.description,C.value.value=l.category,P.value.value=l.sell),m.value.open=!0}function $(){h(),m.value.productId="",m.value.open=!1,H.value.deleteFileRecord()}const U=Ze({name:X().required(u("api.productNameRequired")),price:et().required(u("api.productPriceRequired")).min(0,u("api.productPriceTooSmall")),description:X().required(u("api.productDescriptionRequired")),category:X().required(u("api.productCategoryRequired")).oneOf(["food","drink","music","phone"],u("api.productCategoryInvalid")),sell:tt().required(u("api.productSellRequired"))}),{handleSubmit:M,isSubmitting:b,resetForm:h}=at({validationSchema:U}),f=z("name"),w=z("price"),g=z("description"),C=z("category"),P=z("sell"),T=[{text:u("productCategory.food"),value:"food"},{text:u("productCategory.drink"),value:"drink"},{text:u("productCategory.music"),value:"music"},{text:u("productCategory.phone"),value:"phone"}],H=V(null),v=V([]),I=V([]),N=M(async l=>{var o,r,t;if(!((o=v.value[0])!=null&&o.error)){if(m.value.productId.length===0&&v.value.length===0){p({text:u("api.productImageRequired"),snackbarProps:{color:"red"}});return}try{const n=new FormData;n.append("name",l.name),n.append("price",l.price),n.append("description",l.description),n.append("category",l.category),n.append("sell",l.sell),v.value.length>0&&n.append("image",v.value[0].file),m.value.productId.length>0?await y.patch("/product/"+m.value.productId,n):await y.post("/product",n),d.splice(0),A(),p({text:u(m.value.productId.length>0?"adminProduct.editSuccess":"adminProduct.newSuccess"),snackbarProps:{color:"green"}}),$()}catch(n){console.log(n),p({text:u("api."+(((t=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"error"}})}}});return(l,o)=>{const r=qe("VueFileAgent");return le(),ze(_,null,[a(it,null,{default:s(()=>[a(ot,null,{default:s(()=>[a(re,{cols:"12"},{default:s(()=>[Ee("h1",ft,S(l.$t("nav.adminProducts")),1)]),_:1}),a(He),a(re,{cols:"12"},{default:s(()=>[a(nt,{items:d,headers:x.value},{top:s(()=>[a(st,null,{default:s(()=>[a(L,{onClick:o[0]||(o[0]=t=>R(null))},{default:s(()=>[B(S(l.$t("adminProduct.new")),1)]),_:1}),a(Ge),a(W,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=t=>c.value=t),"prepend-inner-icon":"mdi-magnify",variant:"underlined"},null,8,["modelValue"])]),_:1})]),"item.image":s(({value:t})=>[a(Oe,{src:t,height:"50"},null,8,["src"])]),"item.sell":s(({value:t})=>[t?(le(),Le(Ye,{key:0,icon:"mdi-check"})):_e("",!0)]),"item.createdAt":s(({value:t})=>[B(S(new Date(t).toLocaleString()),1)]),"item.updatedAt":s(({value:t})=>[B(S(new Date(t).toLocaleString()),1)]),"item.category":s(({value:t})=>[B(S(l.$t("productCategory."+t)),1)]),"item.edit":s(({item:t})=>[a(L,{icon:"mdi-pencil",variant:"text",onClick:n=>R(t)},null,8,["onClick"])]),_:2},1032,["items","headers"])]),_:1})]),_:1})]),_:1}),a(We,{modelValue:m.value.open,"onUpdate:modelValue":o[9]||(o[9]=t=>m.value.open=t),persistent:""},{default:s(()=>[a(lt,{disabled:i(b),onSubmit:je(i(N),["prevent"])},{default:s(()=>[a(Ke,null,{default:s(()=>[a(Qe,null,{default:s(()=>[a(W,{modelValue:i(f).value.value,"onUpdate:modelValue":o[2]||(o[2]=t=>i(f).value.value=t),label:l.$t("product.name"),"error-messages":i(f).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(W,{modelValue:i(w).value.value,"onUpdate:modelValue":o[3]||(o[3]=t=>i(w).value.value=t),label:l.$t("product.price"),"error-messages":i(w).errorMessage.value,type:"number",min:"0"},null,8,["modelValue","label","error-messages"]),a(ut,{modelValue:i(C).value.value,"onUpdate:modelValue":o[4]||(o[4]=t=>i(C).value.value=t),"error-messages":i(C).errorMessage.value,items:T,label:l.$t("product.category"),"item-title":"text","item-value":"value"},null,8,["modelValue","error-messages","label"]),a(ct,{modelValue:i(P).value.value,"onUpdate:modelValue":o[5]||(o[5]=t=>i(P).value.value=t),label:l.$t("product.onSell"),"error-messages":i(P).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(vt,{modelValue:i(g).value.value,"onUpdate:modelValue":o[6]||(o[6]=t=>i(g).value.value=t),label:l.$t("product.description"),"error-messages":i(g).errorMessage.value},null,8,["modelValue","label","error-messages"]),a(r,{ref_key:"fileAgent",ref:H,modelValue:v.value,"onUpdate:modelValue":o[7]||(o[7]=t=>v.value=t),"raw-model-value":I.value,"onUpdate:rawModelValue":o[8]||(o[8]=t=>I.value=t),deletable:"","max-size":"1MB","help-text":l.$t("fileAgent.helpText"),"error-text":{type:l.$t("fileAgent.errorType"),size:l.$t("fileAgent.errorSize")}},null,8,["modelValue","raw-model-value","help-text","error-text"])]),_:1}),a(Je,null,{default:s(()=>[a(L,{onClick:$},{default:s(()=>[B(S(l.$t("adminProduct.cancel")),1)]),_:1}),a(L,{type:"submit",loading:i(b)},{default:s(()=>[B(S(l.$t("adminProduct.submit")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["disabled","onSubmit"])]),_:1},8,["modelValue"])],64)}}};typeof oe=="function"&&oe(pt);export{pt as default};

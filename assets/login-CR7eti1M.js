import{R as A,ae as k,af as y,S as T,Y as $,a0 as P,X as l,L as o,ax as m,aj as p,_ as R,Z as s,aO as q,av as g,ag as B,ah as F,an as C}from"./index-Cpz43kHv.js";import{c as L,a as V,u as M,e as v,V as N}from"./index.esm-DFJiPoDg.js";import{v as U}from"./index-BnQpr47X.js";import{V as b,a as D}from"./VRow-CQGUY1bV.js";import{V as I}from"./VContainer-TyyObbe_.js";const j={class:"text-center"},E={class:"text-center"},H={__name:"login",setup(O){const{t:e}=A(),{api:f}=C(),c=k(),h=y(),w=T(),x=L({account:V().required(e("api.userAccountRequired")).min(4,e("api.userAccountTooShort")).max(20,e("api.userAccountTooLong")).test("isAlphanumeric",e("api.userAccountInvalid"),a=>U.isAlphanumeric(a)),password:V().required(e("api.userPasswordRequired")).min(4,e("api.userPasswordTooShort")).max(20,e("api.userPasswordTooLong"))}),{handleSubmit:S,isSubmitting:d}=M({validationSchema:x}),u=v("account"),i=v("password"),_=S(async a=>{var r,t;try{const{data:n}=await f.post("/user/login",{account:a.account,password:a.password});w.login(n.result),c({text:e("login.success"),snackbarProps:{color:"success"}}),h.push("/")}catch(n){console.log(n),c({text:e("api."+(((t=(r=n==null?void 0:n.response)==null?void 0:r.data)==null?void 0:t.message)||"unknownError")),snackbarProps:{color:"error"}})}});return(a,r)=>($(),P(I,null,{default:l(()=>[o(D,null,{default:l(()=>[o(b,{cols:"12"},{default:l(()=>[m("h1",j,p(a.$t("nav.login")),1)]),_:1}),o(R),o(b,{cols:"12"},{default:l(()=>[o(N,{disabled:s(d),onSubmit:q(s(_),["prevent"])},{default:l(()=>[o(g,{modelValue:s(u).value.value,"onUpdate:modelValue":r[0]||(r[0]=t=>s(u).value.value=t),"error-messages":s(u).errorMessage.value,label:a.$t("user.account"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),o(g,{modelValue:s(i).value.value,"onUpdate:modelValue":r[1]||(r[1]=t=>s(i).value.value=t),type:"password","error-messages":s(i).errorMessage.value,label:a.$t("user.password"),minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages","label"]),m("div",E,[o(B,{loading:s(d),type:"submit",color:"primary"},{default:l(()=>[F(p(a.$t("login.submit")),1)]),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{H as default};
